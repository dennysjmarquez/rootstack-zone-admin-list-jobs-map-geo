(this["webpackJsonprootstack-test"]=this["webpackJsonprootstack-test"]||[]).push([[0],{254:function(e,t,n){},255:function(e,t,n){},264:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),c=n(28),i=n.n(c),s=n(379),l=n(390),u=n(50),d=n(97),p=n(183),j=n(185),f=n(25),b=n(34),h=n.n(b),x=n(54),g="FETCH_START",m="FETCH_END",O=function(e){return{type:g,payload:{id:e}}},v="bearer",y=function(){if(r&&null!==localStorage.getItem(v))return r;var e=localStorage.getItem(v);return e?r=function(e){try{var t=e.split("").map((function(e){return/[a-z]/.test(e)?e.toUpperCase():/[A-Z]/.test(e)?e.toLowerCase():"0"===e?"9":/\d/.test(e)?parseInt(e)-1:e})).join(""),n=window.atob(t);return JSON.parse(n)}catch(r){return null}}(e):null},w=function(e){r=e,localStorage.setItem(v,function(e){try{var t=JSON.stringify(e);return window.btoa(t).split("").map((function(e){return/[a-z]/.test(e)?e.toUpperCase():/[A-Z]/.test(e)?e.toLowerCase():"9"===e?"0":/\d/.test(e)?parseInt(e)+1:e})).join("")}catch(n){return null}}(e))},k=function(e){return e.expire<Math.floor(Date.now()/1e3)};var C=function(e){var t,n={access_token:e.access_token,refresh_token:e.access_token,token_type:e.token_type};return n.expire=(null!==(t=e.expires_in)&&void 0!==t?t:e.expiration_time)+Math.floor(Date.now()/1e3),w(n),n},S=0,_=function(){var e=Object(x.a)(h.a.mark((function e(t,n){var r,a,o,c=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]&&c[2],a={method:t,headers:{"Content-Type":"application/json"}},n&&(a.body=JSON.stringify(n)),r){e.next=8;break}return e.next=6,M();case 6:(o=e.sent)&&(a.headers.Authorization=o);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(x.a)(h.a.mark((function e(t,n,r,a,o){var c,i,s,l,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o||y()||!a){e.next=3;break}return e.next=3,W(a);case 3:return e.prev=3,i="https://coding-test.rootstack.net/"+t,a&&(c=O(S++),a(c)),i=i.replace(/\?$/,""),e.next=9,_(n,r,o,a);case 9:return s=e.sent,e.next=12,fetch(i,s);case 12:if((l=e.sent).ok){e.next=19;break}return e.next=16,l.text();case 16:throw u=e.sent,{status:l.status,code:l.status,text:u||"Error de comunicaci\xf3n con el servidor"};case 19:return e.next=21,l.json();case 21:return e.abrupt("return",e.sent);case 24:throw e.prev=24,e.t0=e.catch(3),[401,404].includes(e.t0.status)&&a&&W(a),e.t0;case 28:return e.prev=28,c&&a&&a((d=c.payload.id,{type:m,payload:{id:d}})),e.finish(28);case 31:case"end":return e.stop()}var d}),e,null,[[3,24,28,31]])})));return function(t,n,r,a,o){return e.apply(this,arguments)}}(),T=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A(e,"GET",null,t,n)},I=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return A(e,"POST",t,n,r)},E="UPDATE_SESSION_STATE",F="UPDATE_PROFILE_STATE",P=0,D=1,N=function(e){return{type:E,payload:{state:e}}},J=function(){var e=Object(x.a)(h.a.mark((function e(t){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T("api/auth/me",t);case 2:n=e.sent,r=n.name,a=n.email,t({type:F,payload:{profile:{name:r,email:a}}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(x.a)(h.a.mark((function e(t,n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I("api/auth/login",t,n,!0);case 3:return r=e.sent,C(r),n(N(D)),e.abrupt("return",!0);case 9:e.prev=9,e.t0=e.catch(0),n(N(P));case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(x.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null,localStorage.removeItem(v),t(N(P));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(x.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=y())&&!k(n)){e.next=5;break}return e.abrupt("return",W(t));case 5:t(N(D));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(x.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=y())&&!k(t)){e.next=3;break}return e.abrupt("return",null);case 3:return e.abrupt("return","".concat((n=t.token_type,n.charAt(0).toUpperCase()+n.slice(1))," ").concat(t.access_token));case 4:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}(),z={state:P,profile:{name:"",email:""}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(f.a)(Object(f.a)({},e),{},{state:t.payload.state});case F:return Object(f.a)(Object(f.a)({},e),{},{profile:t.payload.profile});default:return e}},B=n(19),q={loadingIds:[]},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return{loadingIds:[].concat(Object(B.a)(e.loadingIds),[t.payload.id])};case m:return{loadingIds:e.loadingIds.filter((function(e){return e!==t.payload.id}))};default:return e}},H="JOBS_DATA_READY",Z="JOBS_UPDATE_DATA",Y="JOBS_CLEAR_DATA",$=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(){var n=Object(x.a)(h.a.mark((function n(r){var a,o,c,i,s,l,u,d;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:Y}),r({type:H,payload:{loading:!0}}),n.prev=2,n.next=5,T("api/jobs?page=".concat(e),t?r:null);case 5:a=n.sent,o=a.current_page,c=a.next_page_url,i=a.prev_page_url,s=a.per_page,l=a.total,u=a.to,d=a.data,r({type:Z,payload:{data:{data:d,currentPage:o,nextPageUrl:c,prevPageUrl:i,perPage:s,total:l,to:u}}});case 9:return n.prev=9,r({type:H,payload:{loading:!1}}),n.finish(9);case 12:case"end":return n.stop()}}),n,null,[[2,,9,12]])})));return function(e){return n.apply(this,arguments)}}()},K={data:[],nextPageUrl:null,prevPageUrl:null,currentPage:0,perPage:0,total:0,to:0,loading:!1},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return Object(f.a)(Object(f.a)({},e),{},{loading:t.payload.loading});case Z:return Object(f.a)(Object(f.a)({},e),t.payload.data);case Y:return Object(f.a)(Object(f.a)({},e),{},{data:K.data});default:return e}},V=Object(d.combineReducers)({session:R,pageLoading:G,jobs:Q});var X=n(201),ee=Object(X.a)({}),te=(n(254),n(158)),ne=n(26),re=(n(255),n(3)),ae=n(7),oe=n(392),ce=n(393),ie=n(386),se=n(287),le=n(380),ue=n(395),de=n(190),pe=n.n(de),je=n(391),fe=n(2),be=function(e){return Object(fe.jsxs)(se.a,Object(f.a)(Object(f.a)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Copyright \xa9 ",Object(fe.jsx)(je.a,{color:"inherit",href:"https://www.linkedin.com/in/dennysjmarquez/",target:"_blank",children:"Dennys J Marquez"})," ",(new Date).getFullYear(),"."]}))},he=Object(u.b)((function(e){var t=e.session;return{sessionState:t&&t.state}}),(function(e){return{fetchLogin:function(t){return U(t,e)}}}))((function(e){var t=e.fetchLogin,n=e.sessionState,r=e.history,o=Object(a.useState)({email:"",password:""}),c=Object(ae.a)(o,2),i=c[0],s=c[1],l=function(e,t){s((function(n){return Object(f.a)(Object(f.a)({},n),{},Object(re.a)({},e,t))}))};Object(a.useEffect)((function(){if(n===D)return r.replace("/dashboard")}));return Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsxs)(oe.a,{component:"main",maxWidth:"xs",children:[Object(fe.jsxs)(ce.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(fe.jsx)(ie.a,{sx:{m:1,bgcolor:"secondary.main"},children:Object(fe.jsx)(pe.a,{})}),Object(fe.jsx)(se.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(fe.jsxs)(ce.a,{component:"form",onSubmit:function(e){e.preventDefault(),t(i)},noValidate:!0,sx:{mt:1},children:[Object(fe.jsx)(le.a,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,value:i.email,onChange:function(e){return l("email",e.target.value)}}),Object(fe.jsx)(le.a,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",value:i.password,onChange:function(e){return l("password",e.target.value)}}),Object(fe.jsx)(ue.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Sign In"})]})]}),Object(fe.jsx)(be,{sx:{mt:8,mb:4}})]})})})),xe=n(396),ge=n(397),me=n(398),Oe=n(192),ve=n.n(Oe),ye=function(e){var t=e.title,n=void 0===t?"":t,r=e.subTitle,a=e.logoutClick,o=void 0===a?function(){}:a;return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(xe.a,{children:Object(fe.jsxs)(ge.a,{sx:{pr:"24px"},children:[Object(fe.jsx)(se.a,{component:"h1",variant:"h6",color:"inherit",sx:{flexGrow:1,mr:2},children:n}),r&&Object(fe.jsx)(se.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1},children:r}),Object(fe.jsx)(me.a,{color:"inherit",onClick:o,children:Object(fe.jsx)(ve.a,{})})]})}),Object(fe.jsx)(ge.a,{})]})},we=n(399),ke=n(376),Ce=n(400),Se=n(401),_e=n(402),Ae=function(e){var t=e.title,n=void 0===t?"":t,r=e.open,a=e.onAccept,o=void 0===a?function(){}:a,c=e.onClose,i=void 0===c?function(){}:c,s=e.children;return Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsxs)(we.a,{open:r,onClose:i,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",fullWidth:!0,maxWidth:"xs",children:[Object(fe.jsx)(ke.a,{id:"alert-dialog-title",children:n}),Object(fe.jsx)(Ce.a,{children:Object(fe.jsx)(Se.a,{id:"alert-dialog-description",children:s})}),Object(fe.jsxs)(_e.a,{children:[Object(fe.jsx)(ue.a,{onClick:i,children:"Cancelar"}),Object(fe.jsx)(ue.a,{onClick:o,autoFocus:!0,children:"Aceptar"})]})]})})},Te=Object(u.b)(null,(function(e){return{logout:function(){return W(e)}}}))((function(e){var t=e.children,n=e.logout,r=e.headerTitle,o=e.headerSubtitle,c=Object(a.useState)(!1),i=Object(ae.a)(c,2),s=i[0],l=i[1];return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(ce.a,{sx:{display:"flex"},children:Object(fe.jsxs)(ce.a,{component:"main",sx:{backgroundColor:function(e){return"light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900]},flexGrow:1,height:"100vh",overflow:"auto"},children:["*",Object(fe.jsx)(ye,{title:r,subTitle:o,logoutClick:function(){l(!0)}}),Object(fe.jsx)(oe.a,{maxWidth:"xl",sx:{mt:4,mb:4},children:t})]})}),Object(fe.jsx)(Ae,{open:s,onAccept:function(){return n()},onClose:function(){l(!1)},title:"\xa1Atencion!",children:"\xbf Quiere salir del sistema?"})]})})),Ie=n(381),Ee=n(135),Fe=n.n(Ee),Pe=n(388),De=n(394),Ne=n(193),Je=function(e){var t=e.data,n=void 0===t?{}:t,r=e.loading,a=e.page,o=Object(f.a)(Object(f.a)({rows:[],columns:[]},n),{},{loading:r,page:a});return Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(Ne.a,Object(f.a)({},o))})},Ue=n(202),We=n(385),Le=o.a.memo((function(e){var t=e.$prerender,n=e.markerColor,r=e.title;return t?null:Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(We.a,{title:r,placement:"top",children:Object(fe.jsxs)(ce.a,{display:"inline-flex",alignItems:"center",children:[Object(fe.jsx)(ce.a,{sx:{fontSize:12,textShadow:"1px 0 0 #fff, 0px 0 0 #fff, 0 0px 0 #fff, 0 0px 0 #fff, 0px 1px #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff"},children:Object(fe.jsx)("b",{children:r})}),Object(fe.jsx)(Fe.a,{style:{color:n}})]})})})})),Me=o.a.memo((function(e){var t=e.markers,n=void 0===t?[]:t,r=e.mapCenter,a=void 0===r?{lat:0,lng:0}:r;return Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(Ue.a,{bootstrapURLKeys:{key:""},defaultZoom:0,defaultCenter:{lat:0,lng:0},center:a,children:n.map((function(e){var t=e.id,n=e.latitude,r=e.longitude,a=e.title,o=e.markerColor;return Object(fe.jsx)(Le,{title:a,lat:n,lng:r,markerColor:o},t)}))})})})),ze=o.a.memo((function(e){var t=e.jobs,n=void 0===t?[]:t,r=e.getJobs,o=Be(Be),c=Object(a.useState)({lat:0,lng:0}),i=Object(ae.a)(c,2),s=i[0],l=i[1],u=Object(a.useState)({}),d=Object(ae.a)(u,2),p=d[0],j=d[1],f=function(e){!n.loading&&e>0&&r(e)};return Object(a.useEffect)((function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){var t=e.coords,n=t.latitude,r=t.longitude;l({lat:n,lng:r})}),null,{enableHighAccuracy:!0,timeout:6e4,maximumAge:864e5})}),[]),Object(a.useEffect)((function(){if(null===n||void 0===n?void 0:n.data){var e=n.data.map((function(e){return e.markerColor=function(){for(var e="0123456789ABCDEF",t="#",n=0;n<6;n++)t+=e[Math.floor(16*Math.random())];return t}(),e.markerIcon=Object(fe.jsx)(Fe.a,{style:{color:e.markerColor}}),e})),t=n.perPage,r=(n.currentPage,n.total);n.loading;j({pageSize:t,rowsPerPageOptions:[t],rowCount:r,paginationMode:"server",pagination:!0,onPageChange:f,rows:e,columns:[{field:"id",headerName:"id #",minWidth:110,flex:1},{field:"markerIcon",headerName:"Map Marker",width:220,disableReorder:!0,renderCell:function(e){return Object(fe.jsxs)(fe.Fragment,{children:[e.row.markerIcon,Object(fe.jsx)(ue.a,{className:o.root,onClick:function(){var t=e.row,n=t.latitude,r=t.longitude;l({lat:Number(n),lng:Number(r)})},children:"Ubicar en el mapa"})]})}},{field:"title",headerName:"T\xedtulo",minWidth:120,width:250},{field:"description",headerName:"Descripci\xf3n",minWidth:350},{field:"assigned_to",headerName:"Asignado a",width:220},{field:"status",headerName:"status",width:220}]})}}),[n]),Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsxs)(Pe.a,{container:!0,spacing:2,children:[Object(fe.jsx)(Pe.a,{item:!0,xs:12,md:6,lg:6,children:Object(fe.jsx)(De.a,{sx:{p:2,display:"flex",flexDirection:"row",height:500},children:Object(fe.jsx)(Je,{data:p,loading:n.loading,page:n.currentPage})})}),Object(fe.jsx)(Pe.a,{item:!0,xs:12,md:6,lg:6,children:Object(fe.jsx)(De.a,{sx:{p:2,display:"flex",flexDirection:"row",height:500},children:Object(fe.jsx)(Me,{markers:p.rows,mapCenter:s})})})]})})})),Re=Object(u.b)(null,(function(e){return{getJobs:function(t){return e($(t,!1))}}}))(ze),Be=Object(Ie.a)({root:{background:"linear-gradient(45deg, #2196F3 30%, #21CBF3 90%)",borderRadius:"4px !important",boxShadow:"0 3px 5px 2px rgb(0 0 0 / 23%)",color:"white !important",padding:"0 30px !important","&:hover":{background:"linear-gradient(45deg, #0060ad 30%, #21CBF3 90%)"}}});var qe=Object(u.b)((function(e){var t=e.session,n=e.jobs;return{profile:t.profile,jobs:n}}),(function(e){return{getAuthMe:function(){return e(J)},getJobs:function(t){return e($(t))}}}))((function(e){var t=e.profile,n=e.getJobs,r=e.getAuthMe,o=e.jobs;return Object(a.useEffect)((function(){r(),n(0)}),[]),Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(Te,{headerTitle:"Dashboard",headerSubtitle:"".concat(t.name," - ").concat(t.email),children:Object(fe.jsx)(Re,{jobs:o})})})})),Ge=n(90),He=function(e){var t=e.session;return{sessionState:t&&t.state}},Ze=function(e){return Object(Ge.a)(He)((function(t){return t.sessionState===D?Object(fe.jsx)(e,Object(f.a)({},t)):Object(fe.jsx)(ne.a,{to:"/login"})}))},Ye=n(403),$e=n(9),Ke=Object($e.a)("div")({display:"flex",backgroundColor:"#fff",justifyContent:"center",alignItems:"center",position:"fixed",top:0,left:0,zIndex:1301,width:"100%",height:"100%"}),Qe=Object(Ge.a)((function(e){return{pageLoading:e.pageLoading}}))((function(e){return e.pageLoading.loadingIds.length>0?Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(Ke,{children:Object(fe.jsx)(Ye.a,{})})}):null}));var Ve=Object(u.b)((function(e){var t=e.session;return{sessionState:t&&t.state}}))((function(e){var t=e.sessionState;return Object(fe.jsx)(te.a,{children:Object(fe.jsxs)("div",{children:[Object(fe.jsxs)(ne.d,{children:[Object(fe.jsx)(ne.b,{exact:!0,path:"/login",component:he}),Object(fe.jsx)(ne.b,{exact:!0,path:"/dashboard",component:Ze(qe)}),Object(fe.jsx)(ne.b,{exact:!0,path:"/",render:function(){return t===P?Object(fe.jsx)(ne.a,{to:"/login"}):t===D?Object(fe.jsx)(ne.a,{to:"/dashboard"}):(setTimeout(W,0),null)}}),Object(fe.jsx)(ne.a,{to:"/"}),";"]}),Object(fe.jsx)(Qe,{})]})})})),Xe=Object(d.createStore)(V,Object(p.composeWithDevTools)(Object(d.applyMiddleware)(j.a)));Xe.dispatch(L),i.a.render(Object(fe.jsx)(u.a,{store:Xe,children:Object(fe.jsxs)(l.a,{theme:ee,children:[Object(fe.jsx)(s.a,{}),Object(fe.jsx)(Ve,{})]})}),document.getElementById("root"))}},[[264,1,2]]]);
//# sourceMappingURL=main.64ec6b26.chunk.js.map